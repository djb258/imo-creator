openapi: 3.1.0
info:
  title: Composio MCP Server API
  description: |
    Universal AI agent integration platform with 100+ services including Gmail, Google Drive,
    Google Calendar, Google Sheets, GitHub, Vercel, Neon Database, Lovable.dev, Builder.io,
    Figma, Smartsheet, and more. All operations follow HEIR/ORBT compliance format.

    **Key Features:**
    - 100+ integrated services via single endpoint
    - HEIR/ORBT compliant payload format
    - Google Workspace: 3 Gmail accounts, 3 Drive accounts, Calendar, Sheets
    - Million Verifier email validation integration
    - Performance caching (3 minutes)
    - Connection pooling
    - Kill switch support

  version: 1.0.0
  contact:
    name: IMO Creator Support
    email: service@svg.agency

servers:
  - url: http://localhost:3001
    description: Local Composio MCP Server (Development)
  - url: http://localhost:3000
    description: Alternative local port

paths:
  /mcp/health:
    get:
      operationId: getHealth
      summary: Health check with Composio connection status
      description: Returns server health status and tests Composio API connectivity
      responses:
        '200':
          description: Server health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: healthy
                  server:
                    type: string
                    example: composio-mcp
                  timestamp:
                    type: string
                    format: date-time
                  version:
                    type: string
                    example: "1.0.0"
                  environment:
                    type: object
                    properties:
                      composio_api_configured:
                        type: boolean
                      composio_base_url:
                        type: string
                      telemetry_enabled:
                        type: boolean
                  composio_connection:
                    type: string
                    enum: [connected, error]
                  composio_error:
                    type: string
                    description: Error message if connection failed

  /mcp/docs:
    get:
      operationId: getDocs
      summary: Get comprehensive API documentation
      description: Returns detailed documentation including payload format, available tools, and usage examples
      responses:
        '200':
          description: API documentation
          content:
            application/json:
              schema:
                type: object
                properties:
                  server:
                    type: string
                  description:
                    type: string
                  connection:
                    type: object
                  payload_format:
                    type: object
                  available_tools:
                    type: array
                    items:
                      type: object
                  usage_examples:
                    type: object

  /mcp/capabilities:
    get:
      operationId: getCapabilities
      summary: List all platform capabilities
      description: Returns supported toolkits, features, and integration benefits
      responses:
        '200':
          description: Platform capabilities
          content:
            application/json:
              schema:
                type: object
                properties:
                  server:
                    type: string
                  description:
                    type: string
                  features:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        description:
                          type: string
                        supported_toolkits:
                          type: array
                          items:
                            type: string
                  integration_benefits:
                    type: object
                  composio_sdk:
                    type: object

  /mcp/kill-switch:
    get:
      operationId: getKillSwitchStatus
      summary: Check kill switch status
      description: Returns whether the kill switch is active
      responses:
        '200':
          description: Kill switch status
          content:
            application/json:
              schema:
                type: object
                properties:
                  active:
                    type: boolean
                  server:
                    type: string

  /mcp/toolkits:
    get:
      operationId: listToolkits
      summary: List available toolkits
      description: Returns available toolkits grouped by service
      parameters:
        - name: user_id
          in: query
          schema:
            type: string
          description: User ID for context-specific tools
        - name: limit
          in: query
          schema:
            type: integer
          description: Maximum number of toolkits to return
      responses:
        '200':
          description: Available toolkits
          content:
            application/json:
              schema:
                type: object
                properties:
                  server:
                    type: string
                  user_context:
                    type: string
                  available_toolkits:
                    type: object
                  total_tools:
                    type: integer
                  fetched_at:
                    type: string

  /mcp/execute/{toolkit}/{tool}:
    post:
      operationId: executeToolDirect
      summary: Execute a specific tool directly
      description: Quick execution endpoint for specific toolkit/tool combinations
      parameters:
        - name: toolkit
          in: path
          required: true
          schema:
            type: string
          description: Toolkit name (e.g., gmail, github, slack)
        - name: tool
          in: path
          required: true
          schema:
            type: string
          description: Tool name within the toolkit
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                arguments:
                  type: object
                  description: Tool-specific arguments
                user_id:
                  type: string
                  description: User ID for authentication context
      responses:
        '200':
          description: Tool execution result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ToolResult'

  /tool:
    post:
      operationId: executeTool
      summary: Main tool execution endpoint (HEIR/ORBT compliant)
      description: |
        Primary endpoint for executing any Composio tool. All requests MUST follow
        the HEIR/ORBT payload format with required tracking fields.

        **Supported Services:**
        - Gmail (3 accounts: service@svg.agency, djb258@gmail.com, dbarton@svg.agency)
        - Google Drive (3 accounts)
        - Google Calendar (1 account: service@svg.agency)
        - Google Sheets (1 account: service@svg.agency)
        - GitHub, Vercel, Neon Database, Million Verifier
        - 100+ additional services via Composio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ToolRequest'
            examples:
              gmail_send:
                summary: Send Gmail email
                value:
                  tool: gmail_send_email
                  data:
                    to: recipient@example.com
                    subject: Meeting Follow-up
                    body: Thanks for the great meeting today!
                    from: service@svg.agency
                  unique_id: HEIR-2025-10-GMAIL-SEND-01
                  process_id: PRC-GMAIL-1728345600
                  orbt_layer: 2
                  blueprint_version: "1.0"

              gmail_read:
                summary: Read Gmail emails
                value:
                  tool: gmail_list_messages
                  data:
                    account: service@svg.agency
                    max_results: 10
                    query: is:unread
                  unique_id: HEIR-2025-10-GMAIL-READ-01
                  process_id: PRC-GMAIL-1728345601
                  orbt_layer: 2
                  blueprint_version: "1.0"

              drive_upload:
                summary: Upload file to Google Drive
                value:
                  tool: googledrive_upload_file
                  data:
                    name: document.pdf
                    mimeType: application/pdf
                    content: <base64_encoded_content>
                    folderId: <optional_folder_id>
                  unique_id: HEIR-2025-10-DRIVE-UPLOAD-01
                  process_id: PRC-DRIVE-1728345602
                  orbt_layer: 2
                  blueprint_version: "1.0"

              calendar_create:
                summary: Create Google Calendar event
                value:
                  tool: googlecalendar_create_event
                  data:
                    summary: Team Meeting
                    description: Weekly sync meeting
                    start:
                      dateTime: "2025-10-15T10:00:00-07:00"
                    end:
                      dateTime: "2025-10-15T11:00:00-07:00"
                    attendees:
                      - email: team@example.com
                  unique_id: HEIR-2025-10-CAL-CREATE-01
                  process_id: PRC-CAL-1728345603
                  orbt_layer: 2
                  blueprint_version: "1.0"

              sheets_read:
                summary: Read Google Sheets data
                value:
                  tool: googlesheets_get_values
                  data:
                    spreadsheetId: <spreadsheet_id>
                    range: Sheet1!A1:D10
                  unique_id: HEIR-2025-10-SHEETS-READ-01
                  process_id: PRC-SHEETS-1728345604
                  orbt_layer: 2
                  blueprint_version: "1.0"

              sheets_write:
                summary: Write to Google Sheets
                value:
                  tool: googlesheets_update_values
                  data:
                    spreadsheetId: <spreadsheet_id>
                    range: Sheet1!A1:C3
                    values:
                      - ["Name", "Email", "Status"]
                      - ["John Doe", "john@example.com", "Active"]
                      - ["Jane Smith", "jane@example.com", "Active"]
                  unique_id: HEIR-2025-10-SHEETS-WRITE-01
                  process_id: PRC-SHEETS-1728345605
                  orbt_layer: 2
                  blueprint_version: "1.0"

              million_verifier:
                summary: Verify email with Million Verifier
                value:
                  tool: VERIFY_EMAIL
                  data:
                    email: test@example.com
                  unique_id: HEIR-2025-10-VERIFY-01
                  process_id: PRC-VERIFY-1728345606
                  orbt_layer: 2
                  blueprint_version: "1.0"

              github_create_repo:
                summary: Create GitHub repository
                value:
                  tool: github_create_repository
                  data:
                    name: new-project
                    description: My new project
                    private: false
                    auto_init: true
                  unique_id: HEIR-2025-10-GITHUB-CREATE-01
                  process_id: PRC-GITHUB-1728345607
                  orbt_layer: 2
                  blueprint_version: "1.0"

              neon_query:
                summary: Execute Neon database query
                value:
                  tool: neon_query_database
                  data:
                    query: SELECT * FROM users WHERE active = true LIMIT 10
                  unique_id: HEIR-2025-10-NEON-QUERY-01
                  process_id: PRC-NEON-1728345608
                  orbt_layer: 2
                  blueprint_version: "1.0"

              list_accounts:
                summary: List connected Google accounts
                value:
                  tool: manage_connected_account
                  data:
                    action: list
                    app: GMAIL
                  unique_id: HEIR-2025-10-LIST-01
                  process_id: PRC-LIST-1728345609
                  orbt_layer: 2
                  blueprint_version: "1.0"

              get_composio_stats:
                summary: Get Composio statistics
                value:
                  tool: get_composio_stats
                  data: {}
                  unique_id: HEIR-2025-10-STATS-01
                  process_id: PRC-STATS-1728345610
                  orbt_layer: 2
                  blueprint_version: "1.0"
      responses:
        '200':
          description: Tool execution successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ToolResult'
        '400':
          description: Invalid request - missing required HEIR/ORBT fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required HEIR/ORBT fields
                  missing_fields:
                    type: array
                    items:
                      type: string
                  server:
                    type: string
                    example: composio-mcp
        '403':
          description: ORBT Layer exceeded maximum
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: ORBT Layer 5 maximum exceeded
                  server:
                    type: string
        '503':
          description: Service unavailable - kill switch active
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Service temporarily unavailable - kill switch active
                  code:
                    type: string
                    example: KILL_SWITCH_ACTIVE
                  server:
                    type: string
        '500':
          description: Server error during tool execution
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                  server:
                    type: string
                  heir_tracking:
                    type: object
                    properties:
                      unique_id:
                        type: string
                      process_lineage:
                        type: array
                        items:
                          type: string
                      error_occurred:
                        type: boolean
                      error_type:
                        type: string
                      timestamp:
                        type: string

components:
  schemas:
    ToolRequest:
      type: object
      required:
        - tool
        - data
        - unique_id
        - process_id
        - orbt_layer
        - blueprint_version
      properties:
        tool:
          type: string
          description: Name of the Composio tool to execute
          example: gmail_send_email
        data:
          type: object
          description: Tool-specific parameters (varies by tool)
          additionalProperties: true
        unique_id:
          type: string
          description: HEIR-formatted unique identifier (HEIR-YYYY-MM-SYSTEM-MODE-VN)
          pattern: ^HEIR-\d{4}-\d{2}-.+$
          example: HEIR-2025-10-GMAIL-SEND-01
        process_id:
          type: string
          description: Process tracking identifier (PRC-SYSTCODE-EPOCHTIMESTAMP)
          pattern: ^PRC-.+$
          example: PRC-GMAIL-1728345600
        orbt_layer:
          type: integer
          description: ORBT layer level (1-5, higher = more complex operation)
          minimum: 1
          maximum: 5
          example: 2
        blueprint_version:
          type: string
          description: Blueprint version for compatibility tracking
          example: "1.0"

    ToolResult:
      type: object
      properties:
        success:
          type: boolean
          description: Whether the tool execution succeeded
        result:
          type: object
          description: Tool-specific result data
          additionalProperties: true
        error:
          type: string
          description: Error message if execution failed
        execution_id:
          type: string
          description: Unique execution identifier
        heir_tracking:
          type: object
          description: HEIR/ORBT compliance tracking metadata
          properties:
            unique_id:
              type: string
            process_lineage:
              type: array
              items:
                type: string
            orbt_layer:
              type: integer
            timestamp:
              type: string
              format: date-time

    ConnectedAccount:
      type: object
      properties:
        id:
          type: string
          description: Connected account ID
          example: ca_BSkcAvhBMH92
        email:
          type: string
          format: email
          description: Account email address
          example: service@svg.agency
        service:
          type: string
          description: Service name (GMAIL, GOOGLEDRIVE, etc.)
          example: GMAIL
        status:
          type: string
          enum: [active, expired, error]
          description: Connection status
        connected_at:
          type: string
          format: date-time
          description: When the account was connected

  securitySchemes:
    ComposioApiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: |
        Composio API key (configured via COMPOSIO_API_KEY environment variable)
        Get your API key from https://app.composio.dev

security:
  - ComposioApiKey: []

tags:
  - name: Health
    description: Health check and status endpoints
  - name: Documentation
    description: API documentation and capabilities
  - name: Tools
    description: Tool execution endpoints
  - name: Management
    description: Account and toolkit management

externalDocs:
  description: Composio MCP Integration Guide
  url: file://COMPOSIO_INTEGRATION.md
