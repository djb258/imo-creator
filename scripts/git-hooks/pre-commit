#!/usr/bin/env bash
# HEIR/ORBT atomic fix enforcement
if [[ "${BMAD_ALLOW_MULTI:-0}" == "1" ]]; then exit 0; fi
CHANGED=$(git diff --cached --name-only | wc -l | tr -d ' ')
if [[ "$CHANGED" -gt 3 ]]; then
  echo "[HEIR/ORBT] Too many files in one fix ($CHANGED). Atomic fixes only."
  echo "Set BMAD_ALLOW_MULTI=1 to override."
  exit 1
fi