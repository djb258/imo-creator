#!/usr/bin/env bash
MSG_FILE="$1"
grep -q 'BMAD_TRACE_ID=' "$MSG_FILE" || { echo "Commit message must include BMAD_TRACE_ID=..."; exit 1; }
# Require REFAC: prefix when BMAD_MODE=refactor (dev sets env when committing)
if [[ "${BMAD_MODE:-}" == "refactor" ]]; then
  grep -qE '^(REFAC:|Refactor:)' "$MSG_FILE" || { echo "Use REFAC: prefix in commit title during refactor mode."; exit 1; }
fi